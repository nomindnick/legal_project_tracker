{% extends "base.html" %}

{% block title %}Projects{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Projects</h1>
        <a href="/projects/new" class="btn btn-primary">New Project</a>
    </div>

    {# Filter bar - full implementation in Sprint 4.2 #}
    <div class="card mb-4">
        <div class="card-body">
            <form hx-get="/projects/table_rows" hx-target="#table-body" hx-trigger="submit">
                <div class="row g-3">
                    <div class="col-md-4">
                        <input type="text" class="form-control" name="search"
                               placeholder="Search projects..."
                               value="{{ filters.get('search', '') }}">
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" name="status">
                            <option value="">All Statuses</option>
                            {% for status in statuses %}
                            <option value="{{ status }}" {% if filters.get('status') == status %}selected{% endif %}>
                                {{ status }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" name="department">
                            <option value="">All Departments</option>
                            {% for dept in departments %}
                            <option value="{{ dept }}" {% if filters.get('department') == dept %}selected{% endif %}>
                                {{ dept }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <div class="form-check mt-2">
                            <input class="form-check-input" type="checkbox" name="include_completed"
                                   value="true" id="includeCompleted"
                                   {% if filters.get('include_completed') == 'true' %}checked{% endif %}>
                            <label class="form-check-label" for="includeCompleted">
                                Include Completed
                            </label>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-secondary w-100">Apply Filters</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    {# Results count #}
    <p class="text-muted mb-2">Showing {{ projects|length }} project(s)</p>

    {# Projects table #}
    <div class="table-responsive">
        <table class="table table-striped table-hover" id="projects-table">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Project Name</th>
                    <th>Project Group</th>
                    <th>Department</th>
                    <th>Date Assigned</th>
                    <th>Assigned Attorney</th>
                    <th>QCP Attorney</th>
                    <th>Internal Deadline</th>
                    <th>Delivery Deadline</th>
                    <th>Status</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody id="table-body">
                {% include 'partials/project_table_rows.html' %}
            </tbody>
        </table>
    </div>

    {# Export button - functionality in Sprint 6.1 #}
    <div class="mt-3">
        <a href="/projects/export" class="btn btn-outline-secondary">Export to CSV</a>
    </div>
</div>
{% endblock %}
